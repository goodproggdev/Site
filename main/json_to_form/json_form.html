<!DOCTYPE html>
<html lang="it">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Form da JSON</title>
	<style>
		body {
			font-family: Arial, sans-serif;
			background-color: #f9f9f9;
			margin: 0;
			padding: 20px;
		}

		h1 {
			text-align: center;
			color: #333;
		}

		form {
			background: #fff;
			border-radius: 8px;
			padding: 20px;
			box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
			max-width: 500px;
			margin: 20px auto;
		}

		fieldset {
			border: 1px solid #ccc;
			border-radius: 5px;
			margin-bottom: 20px;
			padding: 10px;
		}

		legend {
			font-weight: bold;
			color: #666;
		}

		label {
			display: block;
			margin-bottom: 5px;
			font-weight: bold;
			color: #555;
		}

		input {
			width: calc(100% - 20px);
			padding: 10px;
			margin-bottom: 15px;
			border: 1px solid #ccc;
			border-radius: 5px;
			box-sizing: border-box;
		}

		button {
			display: block;
			width: auto;
			background-color: #4CAF50;
			color: white;
			padding: 8px 15px;
			border: none;
			border-radius: 5px;
			font-size: 14px;
			cursor: pointer;
			margin-top: 10px;
			text-align: center;
		}

		button:hover {
			background-color: #45a049;
		}

		pre {
			background: #f4f4f4;
			padding: 15px;
			border-radius: 8px;
			margin: 20px auto;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			overflow-x: auto;
			max-width: 500px;
		}
	</style>
</head>
<body>
	<h1>Form dinamico da JSON</h1>
	<form id="dynamic-form"></form>
	<button id="submit-btn">Submit</button>
	<pre id="output"></pre>

	<script>
		const jsonEsempio = {
			"nome": "Mario Rossi",
			"età": 30,
			"email": "mario.rossi@example.com",
			"indirizzo": {
				"via": "Via Roma",
				"numero": 10,
				"città": "Milano",
				"CAP": "20100"
			}
		};

		const form = document.getElementById('dynamic-form');
		const output = document.getElementById('output');
		const submitBtn = document.getElementById('submit-btn');

		// Funzione per generare il form
		function generateForm(data, parentKey = '') {
			for (const key in data) {
				const fieldId = parentKey ? `${parentKey}.${key}` : key;

				if (typeof data[key] === 'object' && data[key] !== null) {
					// Genera un gruppo di campi per gli oggetti
					const fieldset = document.createElement('fieldset');
					const legend = document.createElement('legend');
					legend.textContent = key;
					fieldset.appendChild(legend);
					generateForm(data[key], fieldId); // Ricorsione per oggetti annidati
					form.appendChild(fieldset);
				} else {
					// Genera input per i campi primitivi
					const label = document.createElement('label');
					label.textContent = key;
					label.setAttribute('for', fieldId);

					const input = document.createElement('input');
					input.type = typeof data[key] === 'number' ? 'number' : 'text';
					input.id = fieldId;
					input.name = fieldId;
					input.value = data[key];

					form.appendChild(label);
					form.appendChild(input);
				}
			}
		}

		// Genera il form dal JSON
		generateForm(jsonEsempio);

		// Gestione del submit
		submitBtn.addEventListener('click', (event) => {
			event.preventDefault(); // Evita il reload della pagina
			const formData = new FormData(form);
			const result = {};

			for (const [key, value] of formData.entries()) {
				const keys = key.split('.');
				let current = result;

				keys.forEach((k, i) => {
					if (i === keys.length - 1) {
						current[k] = isNaN(value) ? value : Number(value);
					} else {
						current[k] = current[k] || {};
						current = current[k];
					}
				});
			}

			output.textContent = JSON.stringify(result, null, 2);
		});
	</script>
</body>
</html>
